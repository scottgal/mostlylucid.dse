name: "Pytest Test Runner"
type: "executable"
version: "1.0.1"
description: "Runs pytest unit tests with coverage reporting and detailed output"

# Performance metadata (NEW - was missing)
cost_tier: "free"
speed_tier: "fast"
quality_tier: "excellent"
max_output_length: "long"
priority: 100

executable:
  command: "pytest"
  args: ["-v", "--tb=short", "{test_file}"]
  install_command: "pip install pytest"

# Resource constraints (NEW)
constraints:
  timeout_ms: 120000  # 2 minutes for test execution
  max_memory_mb: 512
  max_cpu_percent: 80

# Structured input schema (NEW)
input_schema:
  type: object
  properties:
    test_file:
      type: string
      description: "Path to test file or directory"
      required: true
    verbose:
      type: boolean
      description: "Enable verbose output"
      default: true
    coverage:
      type: boolean
      description: "Enable coverage reporting"
      default: false

# Structured output schema (NEW)
output_schema:
  type: object
  properties:
    exit_code:
      type: integer
      description: "Pytest exit code (0=success)"
    stdout:
      type: string
      description: "Test output"
    stderr:
      type: string
      description: "Error output"
    tests_passed:
      type: integer
      description: "Number of tests passed"
    tests_failed:
      type: integer
      description: "Number of tests failed"

tags: ["python", "testing", "pytest", "unit-tests", "quality-assurance"]

# Examples (NEW)
examples:
  - input: {"test_file": "tests/test_example.py"}
    output: {"exit_code": 0, "tests_passed": 5, "tests_failed": 0}
  - input: {"test_file": "tests/", "coverage": true}
    output: {"exit_code": 0, "tests_passed": 42, "tests_failed": 0}

# Usage documentation (NEW)
usage_notes: |
  ## Overview
  Runs pytest unit tests with configurable verbosity and coverage.

  ## Options
  - **test_file**: Path to test file or directory (required)
  - **verbose**: Show detailed output (-v flag)
  - **coverage**: Generate coverage report (--cov flag)

  ## Exit Codes
  - 0: All tests passed
  - 1: Some tests failed
  - 2: Test execution error
  - 3: Internal pytest error

  ## Performance
  - Typical execution: 1-30 seconds depending on test suite
  - Timeout: 2 minutes maximum

  ## Best Practices
  - Run after code changes
  - Use coverage for quality assessment
  - Integrate into CI/CD pipeline
